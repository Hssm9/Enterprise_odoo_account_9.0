<openerp>
  <data>
      <!--产品视图-->
      <record id="view_res_product_template_form_inherit" model="ir.ui.view">
          <field name="name">view.res.product.template.form.inherit</field>
          <field name="model">product.template</field>
          <field name="inherit_id" ref="product.product_template_only_form_view" />
          <field name="arch" type="xml">
              <field name="list_price" position="attributes">
                  <attribute name="invisible">1</attribute>
              </field>
              <field name="name" position="replace">
                  <field name="name" placeholder="产品型号" string="产品型号"/>
              </field>
              <label for="name" position="attributes">
                  <attribute name="string">产品型号</attribute>
              </label>
              <group name="group_lots_and_weight" position="attributes">
                  <attribute name="invisible">1</attribute>
              </group>
              <label for="standard_price" position="attributes">
                  <attribute name="invisible">1</attribute>
              </label>
              <div name="standard_price_uom" position="attributes">
                  <attribute name="invisible">1</attribute>
              </div>
              <field name="categ_id" position="replace">
                  <attribute name="invisible"></attribute>
              </field>
              <group name="stock_property" position="attributes">
                  <attribute name="invisible">1</attribute>
              </group>
              <field name="default_code" position="attributes">
                  <attribute name="invisible">1</attribute>
              </field>
              <field name="type" position="before">
                  <field name="bom" />
                  <field name="is_temporary_bom"/>
                  <field name="categ_id"/>
                  <field name="pro_type" />
                  <field name="pro_description_out" />
                  <field name="pro_description" />
                  <!--<field name="pro_parent_id" string="上级BOM" widget="many2many_tags"/>-->
              </field>
              <field name="uom_id" position="before">
                  <field name="cost_price" string="成本价" groups="dtdream_sale.group_product_cost_query"/>
                  <field name="list_price" string="目录价" groups="dtdream_sale.group_product_list_query,dtdream_sale.group_product_banshichu_query,dtdream_sale.group_product_system_query,dtdream_sale.group_product_manage,dtdream_sale.group_product_market_query,dtdream_sale.group_product_sale_manager"/>
                  <field name="ref_discount" groups="dtdream_sale.group_product_list_query,dtdream_sale.group_product_banshichu_query,dtdream_sale.group_product_system_query,dtdream_sale.group_product_manage,dtdream_sale.group_product_market_query,dtdream_sale.group_product_sale_manager"/>
                  <field name="office_manager_discount" groups="dtdream_sale.group_product_banshichu_query,dtdream_sale.group_product_system_query,dtdream_sale.group_product_manage,dtdream_sale.group_product_market_query,dtdream_sale.group_product_sale_manager"/>
                  <field name="system_department_discount" groups="dtdream_sale.group_product_system_query,dtdream_sale.group_product_market_query,dtdream_sale.group_product_manage,dtdream_sale.group_product_sale_manager"/>
                  <field name="sale_grant_discount" groups="dtdream_sale.group_product_market_query,dtdream_sale.group_product_manage,dtdream_sale.group_product_sale_manager"/>
                  <!--<field name="market_president_discount" groups="dtdream_sale.group_product_market_query,dtdream_sale.group_product_manage"/>-->
              </field>
              <field name="uom_id" position="after">
                  <field name="pro_version" />
                  <field name="pro_source" />
                  <field name="pro_status" string="状态"/>
                  <field name="effect_time"/>
              </field>
              <field name="uom_po_id" position="attributes">
                  <attribute name="invisible">1</attribute>
              </field>
              <group name="description" position="before">
                  <separator string="备注" colspan="4"/>
                  <field name="remark" colspan="4" nolabel="1"/>
              </group>
              <field name="invoice_policy" position="attributes">
                  <attribute name="invisible">1</attribute>
              </field>
              <field name="type" position="attributes">
                  <attribute name="invisible">1</attribute>
              </field>
              <field name="barcode" position="attributes">
                  <attribute name="invisible">1</attribute>
              </field>
              <group name="group_lots_and_weight" position="after">
                  <group>
                      <field name="type"></field>
                  </group>
              </group>
              <field name="route_ids" position="after">
                  <field name="uom_po_id"></field>
              </field>
              <xpath expr="//page[@name='sales']" position="attributes">
                  <attribute name="invisible">1</attribute>
              </xpath>
              <xpath expr="//group[@name='properties']/parent::page" position="attributes">
                  <attribute name="invisible">1</attribute>
              </xpath>
              <xpath expr="//group[@name='group_general']/parent::group" position="after">
                  <label for="pro_child_ids" string="叶子BOM"/>
                  <field name="pro_child_ids" string="下级BOM" mode="tree" options="{'no_create': True}">
                      <tree string="产品配置" editable="bottom">
                          <field name="dtdream_child_product_id" string="产品型号"/>
                          <field name="child_categ_id" string="产品分类" />
                          <field name="child_bom" string="BOM" />
                          <field name="child_pro_type" string="产品类别"/>
                          <field name="child_pro_description_out" string="产品对外中文描述"/>
                          <field name="child_is_temporary_bom" string="是否临时BOM"/>
                          <field name="child_pro_status" string="状态"/>
                          <field name="child_effect_time" string="生效日期"/>
                          <field name="child_write_uid" string="最后更新人"/>
                          <field name="child_write_date" string="最后更新时间"/>
                          <field name="child_pro_num" string="数量"/>
                      </tree>
                      <form>
                          <sheet>
                              <group>
                                  <group>
                                      <field name="dtdream_child_product_id" string="产品型号"/>
                                      <field name="child_categ_id" string="产品分类" />
                                      <field name="child_bom" string="BOM" />
                                      <field name="child_pro_type" string="产品类别"/>
                                      <field name="child_pro_description_out" string="产品对外中文描述"/>
                                      <field name="child_is_temporary_bom" string="是否临时BOM"/>
                                  </group>
                                  <group>
                                      <field name="child_pro_status" string="状态"/>
                                      <field name="child_effect_time" string="生效日期"/>
                                      <field name="child_write_uid" string="最后更新人"/>
                                      <field name="child_write_date" string="最后更新时间"/>
                                      <field name="child_pro_num" string="数量"/>
                                  </group>
                              </group>
                          </sheet>
                      </form>
                  </field>
              </xpath>
          </field>
      </record>

      <record id="view_res_product_template_tree_view" model="ir.ui.view">
          <field name="name">view.res.product.template.tree</field>
          <field name="model">product.template</field>
          <field name="field_parent">pro_child_ids</field>
          <field name="priority">13</field>
          <field name="arch" type="xml">
              <tree string="Product">
                  <field name="categ_id"/>
                  <field name="bom"/>
                  <field name="name" string="产品型号"/>
                  <field name="pro_type"/>
                  <field name="pro_description_out" />
                  <field name="is_temporary_bom"/>
                  <field name="cost_price" string="成本价" groups="dtdream_sale.group_product_cost_query"/>
                  <field name="list_price" string="目录价" groups="dtdream_sale.group_product_list_query,dtdream_sale.group_product_banshichu_query,dtdream_sale.group_product_system_query,dtdream_sale.group_product_manage,dtdream_sale.group_product_market_query,dtdream_sale.group_product_sale_manager"/>
                  <field name="ref_discount" groups="dtdream_sale.group_product_list_query,dtdream_sale.group_product_banshichu_query,dtdream_sale.group_product_system_query,dtdream_sale.group_product_manage,dtdream_sale.group_product_market_query,dtdream_sale.group_product_sale_manager"/>
                  <field name="office_manager_discount" groups="dtdream_sale.group_product_banshichu_query,dtdream_sale.group_product_system_query,dtdream_sale.group_product_manage,dtdream_sale.group_product_market_query,dtdream_sale.group_product_sale_manager"/>
                  <field name="system_department_discount" groups="dtdream_sale.group_product_system_query,dtdream_sale.group_product_market_query,dtdream_sale.group_product_manage,dtdream_sale.group_product_sale_manager"/>
                  <field name="sale_grant_discount" groups="dtdream_sale.group_product_market_query,dtdream_sale.group_product_manage,dtdream_sale.group_product_sale_manager"/>
                  <!--<field name="market_president_discount" groups="dtdream_sale.group_product_market_query,dtdream_sale.group_product_manage"/>-->
                  <field name="pro_status" string="状态"/>
                  <field name="effect_time"/>
                  <field name="write_uid" string="最后更新人"/>
                  <field name="write_date" string="最后更新时间"/>
              </tree>
          </field>
      </record>

      <!--<record id="action_product_tree_view" model="ir.actions.act_window">-->
          <!--<field name="name">产品层级图</field>-->
          <!--<field name="type">ir.actions.act_window</field>-->
          <!--<field name="res_model">product.template</field>-->
          <!--<field name="view_mode">tree,form</field>-->
          <!--<field name="view_type">tree</field>-->
          <!--<field name="view_id" ref="view_res_product_template_tree_view"/>-->
          <!--<field name="context">{"search_default_filter_to_sell":1}</field>-->
          <!--<field name="domain">[('pro_parent_id','=',False)]</field>-->
          <!--<field name="help" type="html">-->
              <!--<p class="oe_view_nocontent_create">-->
                  <!--Click to define a new product.-->
              <!--</p>-->
              <!--<p>-->
                  <!--You must define a product for everything you sell, whether it's a physical product, a consumable or a service you offer to  customers.-->
              <!--</p>-->
              <!--<p>-->
                  <!--The product form contains information to simplify the sale process: price, notes in the quotation, accounting data, procurement methods, etc.-->
              <!--</p>-->
          <!--</field>-->
      <!--</record>-->

      <!-- 让tree视图里的记录也可双击修改 -->
      <record id="act_dtdream_product_form" model="ir.actions.act_window">
          <field name="name">产品</field>
          <field name="res_model">product.template</field>
          <field name="type">ir.actions.act_window</field>
          <field name="view_type">form</field>
          <field name="view_mode">tree,form</field>
          <field name="view_id" ref="view_res_product_template_tree_view"/>
          <field name="domain">[('id','=',active_id)]</field>
      </record>

      <record id="ir_open_product" model="ir.values">
          <field name='key2'>tree_but_open</field>
          <field name='model'>product.template</field>
          <field name="name">产品</field>
          <field eval="'ir.actions.act_window,%d'%act_dtdream_product_form" name='value'/>
      </record>

      <record id="view_res_product_template_tree_list_view" model="ir.ui.view">
          <field name="name">view.res.product.template.tree.list</field>
          <field name="model">product.template</field>
          <field name="priority">12</field>
          <field name="arch" type="xml">
              <tree string="Product">
                  <field name="categ_id"/>
                  <field name="bom"/>
                  <field name="name" string="产品型号"/>
                  <field name="pro_type"/>
                  <field name="pro_description_out" />
                  <field name="is_temporary_bom"/>
                  <field name="cost_price" string="成本价" groups="dtdream_sale.group_product_cost_query"/>
                  <field name="list_price" string="目录价" groups="dtdream_sale.group_product_list_query,dtdream_sale.group_product_banshichu_query,dtdream_sale.group_product_system_query,dtdream_sale.group_product_manage,dtdream_sale.group_product_market_query,dtdream_sale.group_product_sale_manager"/>
                  <field name="ref_discount" groups="dtdream_sale.group_product_list_query,dtdream_sale.group_product_banshichu_query,dtdream_sale.group_product_system_query,dtdream_sale.group_product_manage,dtdream_sale.group_product_market_query,dtdream_sale.group_product_sale_manager"/>
                  <field name="office_manager_discount" groups="dtdream_sale.group_product_banshichu_query,dtdream_sale.group_product_system_query,dtdream_sale.group_product_manage,dtdream_sale.group_product_market_query,dtdream_sale.group_product_sale_manager"/>
                  <field name="system_department_discount" groups="dtdream_sale.group_product_system_query,dtdream_sale.group_product_market_query,dtdream_sale.group_product_manage,dtdream_sale.group_product_sale_manager"/>
                  <field name="sale_grant_discount" groups="dtdream_sale.group_product_market_query,dtdream_sale.group_product_manage,dtdream_sale.group_product_sale_manager"/>
                  <!--<field name="market_president_discount" groups="dtdream_sale.group_product_market_query,dtdream_sale.group_product_manage"/>-->
                  <field name="pro_status" string="状态"/>
                  <field name="effect_time"/>
                  <field name="write_uid" string="最后更新人"/>
                  <field name="write_date" string="最后更新时间"/>
              </tree>
          </field>
      </record>

      <record id="product.product_template_kanban_view" model="ir.ui.view">
          <field name="name">Product.template.product.kanban</field>
          <field name="model">product.template</field>
          <field name="arch" type="xml">
              <kanban>
                  <field name="image_small"/>
                  <field name="lst_price"/>
                  <field name="is_product_variant"/>
                  <field name="product_variant_count"/>
                  <field name="product_variant_ids"/>
                  <field name="currency_id"/>
                  <templates>
                      <t t-name="kanban-box">
                          <div class="oe_kanban_global_click">
                              <div class="o_kanban_image">
                                  <img t-att-src="kanban_image('product.template', 'image_small', record.id.value)"/>
                              </div>
                              <div class="oe_kanban_details">
                                  <strong>
                                      <span t-if="record.default_code.value">[<field name="default_code"/>]</span>
                                      <field name="name"/>
                                  </strong>
                                  <div t-if="record.product_variant_count.value &gt; 1">
                                      <strong>
                                          <t t-esc="record.product_variant_count.value"/> Variants
                                      </strong>
                                  </div>
                                  <div name="tags"/>
                                  <ul>
                                      <li invisible="True">Price: <field name="lst_price" widget="monetary"></field></li>
                                      <li><strong>bom:</strong><field name="bom"></field></li>
                                      <li><strong>产品对外中文描述:</strong><field name="pro_description_out"></field></li>
                                  </ul>
                                  <div name="tags"/>
                              </div>
                          </div>
                      </t>
                  </templates>
              </kanban>
          </field>
      </record>

      <!--产品搜索视图-->
      <record id="product_template_search_view" model="ir.ui.view">
          <field name="name">product.template.search</field>
          <field name="model">product.template</field>
          <field name="arch" type="xml">
              <search string="Product">
                  <field name="bom" string="BOM"/>
                  <field name="name" string="产品型号"/>
                  <field name="pro_type" string="产品类别"/>
                  <field name="pro_description_out" string="产品对外中文描述"/>
                  <field name="seller_ids" string="供应商"/>
                  <filter string="产品一级分类" name="categ_id_leavel_one" domain="[('categ_id.parent_id','=',False)]"/>
                  <filter string="产品二级分类" name="categ_id_leavel_two" domain="[('categ_id.parent_id.parent_id','=',False)]"/>
                  <filter string="产品三级分类" name="categ_id_leavel_three" domain="[('categ_id.parent_id.parent_id.parent_id','=',False)]"/>
                  <filter string="产品状态--生产" name="pro_status_outPro" domain="[('pro_status','=','inPro')]"/>
                  <filter string="产品状态--停产" name="pro_status_inPro" domain="[('pro_status','=','outPro')]"/>
                  <filter string="产品来源--自研" name="pro_source_own" domain="[('pro_source','=','1')]"/>
                  <filter string="产品来源--外购" name="pro_source_buy" domain="[('pro_source','=','2')]"/>
              </search>
          </field>
      </record>

      <record id="product.product_template_action" model="ir.actions.act_window">
          <field name="name">产品列表</field>
          <field name="type">ir.actions.act_window</field>
          <field name="res_model">product.template</field>
          <field name="view_mode">tree,kanban,form</field>
          <field name="view_type">form</field>
          <field name="view_id" ref="view_res_product_template_tree_list_view"/>
          <field name="search_view_id" ref="product_template_search_view"/>
          <field name="context">{"search_default_filter_to_sell":1}</field>
          <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                  Click to define a new product.
              </p>
              <p>
                  You must define a product for everything you sell, whether it's a physical product, a consumable or a service you offer to  customers.
              </p>
              <p>
                  The product form contains information to simplify the sale process: price, notes in the quotation, accounting data, procurement methods, etc.
              </p>
          </field>
      </record>

      <!--重写机会点tree视图-->
      <record id="view_res_product_leads_tree_view" model="ir.ui.view">
            <field name="name">view.res.product.leads.tree</field>
            <field name="model">crm.lead</field>
            <field name="inherit_id" ref="crm.crm_case_tree_view_leads"/>
            <field name="arch" type="xml">
                <field name="name" position="before">
                    <field name="project_number"/>
                </field>
                <field name="name" position="attributes">
                    <attribute name="string">项目名称</attribute>
                </field>
                <field name="name" position="after">
                    <field name="is_red" invisible="1"/>
                    <field name="project_leave" string="项目级别"/>
                    <field name="office_id"/>
                    <field name="system_department_id"/>
                    <field name="bidding_time"/>
                    <field name="space_total" string="项目空间（万元）"/>
                    <field name="software_space"/>
                    <field name="project_master_degree"/>
                    <field name="sale_apply_id"/>
                    <field name="user_id" string="创建人" invisible="True" on_change="on_change_user(user_id, context)" context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'dtdream_sale.group_dtdream_sale_salesman_all_leads'], 'team_id': team_id}"/>
                    <field name="write_date" string="更新时间"/>
                </field>
                <field name="create_date" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="contact_name" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="country_id" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="email_from" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="phone" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="stage_id" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="team_id" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
            </field>
        </record>

      <!--项目管理字段添加-->
      <record id="view_res_product_oppr_form" model="ir.ui.view">
            <field name="name">view.res.product.oppr</field>
            <field name="model">crm.lead</field>
            <field name="inherit_id" ref="crm.crm_case_form_view_oppor"/>
            <field name="arch" type="xml">
                <field name="stage_id" position="replace">
                    <field name="stage_id" widget="statusbar" class="opp_stage"
                            options="{'fold_field': 'fold'}"
                            domain="[]"
                            attrs="{'invisible': [('active', '=', False)]}"/>
                </field>
                <xpath expr="//header/child::button[1]" position="replace">
                    <button name="crm_lead_won_action" string="中标"
                                type="object" class="oe_highlight"
                                attrs="{'invisible': ['|', ('is_lost','=',True), ('is_won', '=', True)]}"/>
                </xpath>
                <xpath expr="//header/child::button[2]" position="replace">
                    <button name="%(crm.crm_lead_lost_action)d" string="丢单"
                                type="action" class="oe_highlight"
                                context="{'default_lead_id': active_id}"
                                attrs="{'invisible': ['|', ('is_lost','=',True), ('is_won', '=', True)]}"/>
                </xpath>
                <xpath expr="//header/child::button[3]" position="replace">
                    <button name="action_set_important" string="标记为重点"
                                type="object" class="oe_highlight" groups="dtdream_sale.group_dtdream_marketing_department_project_interface_person" attrs="{'invisible': [ ('is_important','=',True)]}"/>
                </xpath>
                <xpath expr="//header/child::button[4]" position="replace">
                    <button name="action_cancel_important" string="取消重点"
                                type="object" class="oe_highlight" groups="dtdream_sale.group_dtdream_marketing_department_project_interface_person" attrs="{'invisible': [ ('is_important','=',False)]}"/>
                </xpath>
                <div class="label label-danger pull-right" position="replace">
                    <div class="label label-danger pull-right" attrs="{'invisible': [('is_lost', '=', False)]}">丢单</div>
                </div>
                <div class="label label-success pull-right" position="replace">
                    <div class="label label-success pull-right" attrs="{'invisible': [('is_won', '=', False)]}">中标</div>
                </div>
                <div class="label label-success pull-right" position="after">
                    <div class="label label-info pull-right" attrs="{'invisible': [('is_important', '=', False)]}">重点</div>
                </div>
                <field name="partner_id" position="before">
                    <field name="software_space" invisible="True"/>
                    <field name="is_red" invisible="1"/>
                    <field name="is_won" invisible="1"/>
                    <field name="is_lost" invisible="1"/>
                    <field name="is_important" invisible="1"/>
                    <field name="project_number"/>
                    <field name="sale_apply_id_uid" invisible="True"/>
                    <field name="project_leave" string="项目级别"/>
                    <field name="project_province_new" options="{'no_create': True}"/>
                    <field name="project_place_new" options="{'no_create': True}"/>
                    <field name="project_country" options="{'no_create': True}"/>
                    <field name="office_id" options="{'no_create': True}"/>
                    <field name="system_department_id" domain="[('parent_id','=',False)]" options="{'no_create': True}"/>
                    <field name="industry_id" domain="[('parent_id.parent_id','=',False)]" options="{'no_create': True}"/>
                    <field name="project_detail"/>
                    <field name="sale_channel"/>
                    <field name="product_category_type_id" widget="many2many_tags" invisible="True"/>
                </field>
                <button name="action_schedule_meeting" position="attributes">
                    <attribute name="invisible">1</attribute>
                </button>
                <xpath expr="//field[@name='sale_number']/parent::div/parent::button" position="attributes">
                        <attribute name="invisible">1</attribute>
                </xpath>
                <button name="toggle_active" position="replace">
                    <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive" groups="dtdream_sale.group_dtdream_sale_manager"
                            attrs="{'invisible': [('active', '=', True), ('probability', '&lt;', 100)]}">
                        <field name="active" widget="boolean_button" options='{"terminology": "archive"}'/>
                    </button>
                </button>
                <!--<button name="toggle_active" position="before">-->
                    <!--<button name="%(action_contract_fee)d" type="action" class="oe_stat_button dtdream_info_btn" icon="fa-pencil-square-o">-->
                          <!--<div class="o_stat_info">-->
                              <!--<field name="sum_of_contract_fee" class="o_stat_value"/>-->
                              <!--<span class="o_stat_text">合同额(万元)</span>-->
                          <!--</div>-->
                    <!--</button>-->
                    <!--<button name="%(action_cash_income)d" type="action" class="oe_stat_button dtdream_info_btn" icon="fa-pencil-square-o">-->
                          <!--<div class="o_stat_info">-->
                              <!--<field name="sum_of_cash_income" class="o_stat_value"/>-->
                              <!--<span class="o_stat_text">现金收入(万元)</span>-->
                          <!--</div>-->
                    <!--</button>-->
                    <!--<button name="%(action_gaap_income)d" type="action" class="oe_stat_button dtdream_info_btn" icon="fa-pencil-square-o">-->
                          <!--<div class="o_stat_info">-->
                              <!--<field name="sum_of_gaap_income" class="o_stat_value"/>-->
                              <!--<span class="o_stat_text">GAAP收入(万元)</span>-->
                          <!--</div>-->
                    <!--</button>-->
                    <!--<button name="%(action_fee_pay)d" type="action" class="oe_stat_button dtdream_info_btn" icon="fa-pencil-square-o">-->
                          <!--<div class="o_stat_info">-->
                              <!--<field name="sum_of_fee_pay" class="o_stat_value"/>-->
                              <!--<span class="o_stat_text">费用支出(万元)</span>-->
                          <!--</div>-->
                    <!--</button>-->
                <!--</button>-->
                <field name="partner_id" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="email_from" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="name" position="attributes">
                    <attribute name="string">项目名称</attribute>
                </field>
                <field name="phone" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <div class="o_address_format" position="attributes">
                    <attribute name="invisible">1</attribute>
                </div>
                <div class="o_address_format" position="replace">
                </div>
                <field name="partner_name" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="partner_name" position="replace">
                </field>
                <label for="street" position="attributes">
                    <attribute name="invisible">1</attribute>
                </label>
                <field name="date_deadline" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="team_id" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="team_id" position="replace">
                </field>
                <field name="user_id" position="after">
                    <field name="team_id" domain="[('user_id','=',-99)]"/>
                </field>
                <field name="user_id" position="replace">
                      <field name="sale_apply_id"/>
                      <field name="user_id" on_change="on_change_user(user_id, context)" invisible="True"
                                    context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'dtdream_sale.group_dtdream_sale_salesman_all_leads'], 'team_id': team_id}"
                                    domain="[('login','!=','admin')]"/>
                  </field>
                <h2 position="attributes">
                    <attribute name="invisible">1</attribute>
                </h2>
                <field name="email_from" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="function" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="phone" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <div class="o_row" position="attributes">
                    <attribute name="invisible">1</attribute>
                </div>
                <field name="probability" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="fax" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <label for="contact_name" position="attributes">
                    <attribute name="invisible">1</attribute>
                </label>
                <field name="contact_name" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="title" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="title" position="replace">
                </field>
                <div class="o_row" position="attributes">
                    <attribute name="invisible">1</attribute>
                </div>
                <field name="mobile" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="mobile" position="replace">
                </field>
                <field name="priority" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="date_deadline" position="after">
                    <field name="bidding_time"/>
                    <field name="supply_time"/>
                    <field name="pre_implementation_time"/>
                    <field name="pre_check_time"/>
                    <field name="project_master_degree"/>
                    <field name="ali_division"/>
                    <field name="ali_saleman"/>
                    <field name="is_dtdream_integrated"/>
                    <field name="is_project_budget" class="is_budget"/>
                    <field name="is_invest_project"/>
                    <field name="partner_id" string="客户"
                           domain="[('customer','=','True')]"/>
                    <field name="dt_contact_name"/>
                    <field name="dt_mobile"/>
                </field>
                <div class="o_row mr16" position="attributes">
                    <attribute name="invisible">1</attribute>
                </div>
                <label for="next_activity_id" position="replace">
                    <attribute name="invisible"></attribute>
                </label>
                <xpath expr="//field[@name='description']" position="attributes">
                    <attribute name="invisible">True</attribute>
                </xpath>
                <xpath expr="//field[@name='description']" position="after">
                    <field name="des_records" >
                        <tree string="项目进展">
                            <field name="name"/>
                            <field name="write_uid" string="更新人"/>
                            <field name="write_date" string="更新时间"/>
                        </tree>
                        <form>
                            <sheet>
                                <group>
                                    <field name="name"></field>
                                </group>
                            </sheet>
                        </form>
                    </field>
                </xpath>
                <field name="tag_ids" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="lost_reason" position="replace">
                    <field name="lost_reason" string="丢单原因" attrs="{'invisible':[('is_lost','=',False)]}" options="{'no_open': True}"/>
                </field>
                <field name="lost_reason" position="after">
                    <field name="bidding_channel" attrs="{'invisible':[('is_won','=',False)]}"/>
                    <field name="if_zhitou" attrs="{'invisible':[('is_won','=',False)]}"/>
                </field>
                <xpath expr="//field[@name='description']/parent::page" position="after">
                    <page string="投资类项目背景" attrs="{'invisible':[('is_invest_project','!=','1')]}">
                        <field name="pro_background" placeholder="请输入投资类项目背景"/>
                    </page>
                </xpath>
                <xpath expr="//field[@name='description']/parent::page" position="before">
                    <page string="项目空间">
                            <field name="project_space" mode="tree">
                                <tree string="项目空间" editable="bottom" class="dtdream_project_space_tree">
                                    <field name="view_bidding_space" invisible="1"/>
                                    <field name="categ_id_parent" options="{'no_create': True}"/>
                                    <field name="categ_id" options="{'no_create': True}"/>
                                    <field name="project_space"/>
                                    <field name="software_space"/>
                                    <field name="bidding_space" attrs="{'invisible':[('view_bidding_space','=',False)]}"/>
                                </tree>
                                <form>
                                    <sheet>
                                        <group>
                                            <group>
                                                <field name="categ_id_parent"/>
                                                <field name="categ_id"/>
                                            </group>
                                            <group>
                                                <field name="project_space"/>
                                            </group>
                                        </group>
                                    </sheet>
                                </form>
                            </field>
                            <group class="oe_subtotal_footer oe_right" name="project_space_total">
                                <field name="space_total"  class="oe_subtotal_footer_separator"/>
                                <field name="bidding_space_total"  class="oe_subtotal_footer_separator" attrs="{'invisible':[('is_won','=',False)]}"/>
                            </group>
                    </page>
                    <page string="产品配置">
                            <field name="product_line" mode="tree">
                                <tree string="产品配置">
                                    <field name="pro_name" string="产品型号" />
                                    <field name="bom" string="BOM" />
                                    <field name="pro_type" string="产品类别"/>
                                    <field name="pro_description" string="产品对内中文描述"/>
                                    <field name="pro_uom_name" string="单位"/>
                                    <field name="list_price" string="目录价"/>
                                    <field name="ref_discount" string="参考折扣(%)"/>
                                    <field name="apply_discount" string="申请折扣(%)"/>
                                    <field name="pro_num" string="数量"/>
                                    <!--<field name="config_set" string="发货地"/>-->
                                </tree>
                                <form>
                                    <sheet>
                                        <group>
                                            <group>
                                                <field name="pro_name" invisible="True"/>
                                                <field name="product_id" string="产品型号"/>
                                                <field name="bom" string="BOM" readonly="True"/>
                                                <field name="pro_type" string="产品类别" readonly="True"/>
                                                <field name="pro_description" string="产品对内中文描述" readonly="True"/>
                                                <field name="list_price" string="目录价" readonly="True"/>
                                            </group>
                                            <group>
                                                <field name="ref_discount" string="参考折扣(%)" readonly="True"/>
                                                <field name="apply_discount" string="申请折扣(%)"/>
                                                <field name="pro_uom_name" string="单位"/>
                                                <field name="pro_num" string="数量"/>
                                                <!--<field name="config_set" string="发货地"/>-->
                                            </group>
                                        </group>
                                    </sheet>
                                </form>
                            </field>
                            <group class="oe_subtotal_footer oe_right" name="product_total">
                                <field name="total_list_price"  class="oe_subtotal_footer_separator"/>
                                <field name="total_ref_price" class="oe_subtotal_footer_separator"/>
                                <field name="total_apply_price" class="oe_subtotal_footer_separator"/>
                            </group>
                    </page>
                </xpath>
                <!--<xpath expr="//header/child::button[3]" position="attributes">-->
                    <!--<attribute name="invisible">1</attribute>-->
                <!--</xpath>-->
                <xpath expr="//page[@name='lead']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
            </field>
      </record>

      <!--<delete model="ir.values" id="crm.action_mark_as_lost"/>-->
      <!--<record id="crm.action_mark_as_lost" model="ir.actions.server">-->
          <!--<field name="name">Mark As Lost</field>-->
          <!--<field name="model_id" ref="model_crm_lead"/>-->
          <!--<field name="state">code</field>-->
          <!--<field name="code">-->
              <!--if context.get('active_model') == 'crm.lead' and context.get('active_ids'):-->
              <!--self.case_mark_lost(cr, uid, context['active_ids'], context=context)-->
          <!--</field>-->
      <!--</record>-->

      <!--<delete model="ir.values" id="crm.ir_mark_as_lost"/>-->
      <!--<record id="crm.ir_mark_as_lost" model="ir.values">-->
          <!--<field eval="'client_action_multi'" name="key2"/>-->
          <!--<field eval="'crm.lead'" name="model"/>-->
          <!--<field name="name">Mark As Lost</field>-->
      <!--</record>-->
      <!--重写项目管理tree视图-->
      <!-- Opportunities Tree View -->
        <record model="ir.ui.view" id="crm.crm_case_tree_view_oppor">
            <field name="name">Opportunities Tree</field>
            <field name="model">crm.lead</field>
            <field name="priority">8</field>
            <field name="arch" type="xml">
                <tree colors="red:is_red==True" string="Opportunities" decoration-bf="message_needaction==True" decoration-muted="probability == 100" decoration-danger="date_action and (date_action &lt; current_date)">
                    <field name="is_red" invisible="1"/>
                    <field name="is_important" invisible="1"/>
                    <field name="date_deadline" invisible="1"/>
                    <field name="create_date" invisible="1"/>
                    <field name="partner_id" string="Customer" invisible="1"/>
                    <field name="country_id" invisible="1"/>
                    <field name="date_action" invisible="1"/>
                    <field name="title_action" invisible="1"/>
                    <field name="medium_id" invisible="1"/>
                    <field name="campaign_id" invisible="1"/>
                    <field name="source_id" invisible="1"/>
                    <field name="stage_id" invisible="1"/>
                    <field name="planned_revenue" sum="Expected Revenues" invisible="1"/>
                    <field name="probability" avg="Avg. of Probability" invisible="1"/>
                    <field name="team_id" invisible="1"/>
                    <field name="user_id" invisible="1"/>
                    <field name="referred" invisible="1"/>
                    <field name="priority" invisible="1"/>
                    <field name="message_needaction" invisible="1"/>
                    <field name="probability" invisible="1"/>

                    <field name="project_number"/>
                    <field name="name" string="项目名称"/>
                    <field name="project_leave" string="项目级别"/>
                    <field name="office_id"/>
                    <field name="system_department_id"/>
                    <field name="bidding_time"/>
                    <field name="space_total" string="项目空间（万元）"/>
                    <field name="software_space"/>
                    <field name="project_master_degree"/>
                    <field name="sale_apply_id"/>
                    <field name="write_date" string="更新时间" widget="date"/>
                    <field name="stage_id" string="阶段"/>
                    <field name="is_project_budget" invisible="1"/>
                    <field name="is_dtdream_integrated" invisible="1"/>
                    <field name="is_invest_project" invisible="1"/>
                    <field name="ali_division" invisible="1"/>
                </tree>
            </field>
        </record>

      <!--产品类别-->
      <record id="product_pro_type_form_view" model="ir.ui.view">
          <field name="name">product.pro.type.form</field>
          <field name="model">product.pro.type</field>
          <field name="arch" type="xml">
              <form string="产品类别">
                  <sheet>
                      <group>
                          <field name="name"/>
                      </group>
                      <group>

                      </group>
                  </sheet>
              </form>
          </field>
      </record>

      <!--项目查阅权限视图-->
      <record id="view_res_users_access_form_inherit" model="ir.ui.view">
          <field name="name">view.res.users.access.form.inherit2</field>
          <field name="model">res.users</field>
          <field name="inherit_id" ref="base.view_users_form" />
          <field name="arch" type="xml">
              <xpath expr="//page[@name='access_rights']" position="after">
                  <page name="access_office" string="办事处">
                      <field name="user_access_office" widget="many2many_kanban">
                          <kanban quick_create="false" create="true" delete="true">
                              <field name="name"/>
                              <templates>
                                  <t t-name="kanban-box">
                                      <div class="oe_kanban_global_click" style="position: relative">
                                          <a t-if="! read_only_mode" type="delete" style="position: absolute; right: 0; padding: 4px; diplay: inline-block">X</a>
                                          <div class="oe_module_vignette">
                                              <img t-att-src="kanban_image('res.users', 'image_small', record.id.value)" class="oe_avatar oe_kanban_avatar_smallbox"/>
                                              <div class="oe_module_desc">
                                                  <field name="name"/>
                                              </div>
                                          </div>
                                      </div>
                                  </t>
                              </templates>
                          </kanban>
                      </field>
                  </page>
                  <page name="access_industry" string="行业">
                      <field name="user_access_industry" widget="many2many_kanban" domain="[('parent_id.parent_id','=',False)]" context="{'search_default_group_by_parent_id':'parent_id'}">
                          <kanban create="true"  delete="true" >
                              <field name="name"/>
                              <templates>
                                  <t t-name="kanban-box">
                                      <div class="oe_kanban_global_click" style="position: relative">
                                          <a t-if="! read_only_mode" type="delete" style="position: absolute; right: 0; padding: 4px; diplay: inline-block">X</a>
                                          <div class="oe_module_vignette">
                                              <img t-att-src="kanban_image('res.users', 'image_small', record.id.value)" class="oe_avatar oe_kanban_avatar_smallbox"/>
                                              <div class="oe_module_desc">
                                                  <field name="name"/>
                                              </div>
                                          </div>
                                      </div>
                                  </t>
                              </templates>
                          </kanban>
                      </field>
                  </page>
                  <page name="access_product_type" string="产品类">
                      <field name="user_access_product_type" widget="many2many_kanban" context="{'search_default_group_by_parent_id':'parent_id'}">
                          <kanban quick_create="false" create="true" delete="true">
                              <field name="name"/>
                              <templates>
                                  <t t-name="kanban-box">
                                      <div class="oe_kanban_global_click" style="position: relative">
                                          <a t-if="! read_only_mode" type="delete" style="position: absolute; right: 0; padding: 4px; diplay: inline-block">X</a>
                                          <div class="oe_module_vignette">
                                              <img t-att-src="kanban_image('res.users', 'image_small', record.id.value)" class="oe_avatar oe_kanban_avatar_smallbox"/>
                                              <div class="oe_module_desc">
                                                  <field name="name"/>
                                              </div>
                                          </div>
                                      </div>
                                  </t>
                              </templates>
                          </kanban>
                      </field>
                  </page>
                  <page name="access_department" string="部门">
                      <field name="user_access_department" widget="many2many_kanban" domain="[('parent_id','!=',False),('parent_id.name','=','市场部')]">
                          <kanban quick_create="false" create="true" delete="true">
                              <field name="name"/>
                              <templates>
                                  <t t-name="kanban-box">
                                      <div class="oe_kanban_global_click" style="position: relative">
                                          <a t-if="! read_only_mode" type="delete" style="position: absolute; right: 0; padding: 4px; diplay: inline-block">X</a>
                                          <div class="oe_module_vignette">
                                              <img t-att-src="kanban_image('res.users', 'image_small', record.id.value)" class="oe_avatar oe_kanban_avatar_smallbox"/>
                                              <div class="oe_module_desc">
                                                  <field name="name"/>
                                              </div>
                                          </div>
                                      </div>
                                  </t>
                              </templates>
                          </kanban>
                      </field>
                  </page>

              </xpath>
          </field>
      </record>

      <!--定义产品类别action-->
      <record id="product_pro_type_form_action" model="ir.actions.act_window">
          <field name="name">产品类别</field>
          <field name="type">ir.actions.act_window</field>
          <field name="res_model">product.pro.type</field>
          <field name="view_type">form</field>
          <field name="view_mode">tree,form</field>
      </record>

      <!-- 定义机会点 -->
      <record model="ir.ui.view" id="dtdream_sale.crm_lead_form">
          <field name="name">机会点</field>
          <field name="model">crm.lead</field>
          <field name="inherit_id" ref="crm.crm_case_form_view_leads"/>
          <field name="arch" type="xml">
              <field name="partner_id" position="before">
                  <field name="software_space" invisible="True"/>
                  <field name="is_red" invisible="1"/>
                  <field name="sale_apply_id_uid" invisible="True"/>
                  <field name="project_number"/>
                  <field name="project_leave" string="项目级别"/>
                  <field name="project_province_new"  options="{'no_create': True}"/>
                  <field name="project_place_new" options="{'no_create': True}"/>
                  <field name="project_country" options="{'no_create': True}"/>
                  <field name="office_id"  options="{'no_create': True}"/>
                  <field name="system_department_id" domain="[('parent_id','=',False)]" options="{'no_create': True}"/>
                  <field name="industry_id" domain="[('parent_id.parent_id','=',False)]" options="{'no_create': True}"/>
                  <field name="project_detail"/>
                  <field name="sale_channel"/>
                  <field name="product_category_type_id" widget="many2many_tags" invisible="True"/>
              </field>
              <!--<button name="action_set_lost" position="replace">-->
                  <!--<button name="action_set_lost" string="标记为失去"-->
                            <!--type="object" class="oe_highlight"-->
                            <!--groups="dtdream_sale.group_dtdream_sale_manager"-->
                            <!--/>-->
              <!--</button>-->
              <button name="toggle_active" position="replace">
                  <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive" groups="dtdream_sale.group_dtdream_sale_manager"
                            attrs="{'invisible': [('active', '=', True), ('probability', '&lt;', 100)]}">
                        <field name="active" widget="boolean_button" options='{"terminology": "archive"}'/>
                    </button>
              </button>
              <field name="name" position="replace">
                  <field name="name" placeholder="项目名称"/>
              </field>
              <field name="tag_ids" position="attributes">
                  <attribute name="invisible">1</attribute>
              </field>
              <div class="o_address_format" position="attributes">
                  <attribute name="invisible">1</attribute>
              </div>
              <div class="o_row" position="attributes">
                  <attribute name="invisible">1</attribute>
              </div>
              <field name="title" position="attributes">
                  <attribute name="invisible">1</attribute>
              </field>
              <label for="contact_name" position="attributes">
                  <attribute name="invisible">1</attribute>
              </label>
              <field name="title" position="replace">
              </field>
              <field name="partner_id" position="attributes">
                  <attribute name="invisible">1</attribute>
              </field>
              <field name="email_from" position="attributes">
                  <attribute name="invisible">1</attribute>
              </field>
              <field name="function" position="attributes">
                  <attribute name="invisible">1</attribute>
              </field>
              <field name="phone" position="attributes">
                  <attribute name="invisible">1</attribute>
              </field>
              <field name="priority" position="attributes">
                  <attribute name="invisible">1</attribute>
              </field>

              <field name="partner_name" position="attributes">
                  <attribute name="invisible">1</attribute>
              </field>
              <label for="street" position="attributes">
                  <attribute name="invisible">1</attribute>
              </label>
              <field name="mobile" position="attributes">
                  <attribute name="invisible">1</attribute>
              </field>
              <field name="mobile" position="before">
                  <!--<field name = "child_ids"></field>-->
                  <field name="bidding_time"/>
                  <field name="supply_time"/>
                  <field name="pre_implementation_time"/>
                  <field name="pre_check_time"/>
                  <field name="project_master_degree"/>
                  <field name="ali_division"/>
                  <field name="ali_saleman"/>
                  <field name="is_dtdream_integrated"/>
                  <field name="is_invest_project"/>
                  <field name="partner_id" string="客户"
                         options='{"create_name_field": "name"}'
                         domain="[('customer','=','True')]"/>
                  <field name="dt_partner_name" string="公司名称"/>
                  <field name="dt_contact_name"/>
                  <field name="dt_mobile"/>
              </field>
              <field name="fax" position="attributes">
                  <attribute name="invisible">1</attribute>
              </field>
              <field name="user_id" position="replace">
                  <field name="sale_apply_id"/>
                  <field name="user_id" on_change="on_change_user(user_id, context)" invisible="True"
                                context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'dtdream_sale.group_dtdream_sale_salesman_all_leads'], 'team_id': team_id}"
                                domain="[('login','!=','admin')]"/>
              </field>
              <field name="team_id" position="replace">
              </field>
              <field name="user_id" position="after">
                  <field name="team_id" domain="[('user_id','=',-99)]"/>
              </field>
              <xpath expr="//field[@name='description']" position="attributes">
                  <attribute name="string">项目进展</attribute>
              </xpath>
              <xpath expr="//field[@name='description']" position="attributes">
                  <attribute name="invisible">True</attribute>
              </xpath>
              <xpath expr="//field[@name='description']" position="after">
                  <field name="des_records">
                      <tree string="项目进展">
                          <field name="name"/>
                          <field name="write_uid" string="更新人"/>
                          <field name="write_date" string="更新时间"/>
                      </tree>
                      <form>
                          <sheet>
                              <group>
                                  <field name="name"></field>
                              </group>
                          </sheet>
                      </form>
                    </field>
              </xpath>
              <xpath expr="//field[@name='description']/parent::page" position="after">
                    <page string="投资类项目背景" attrs="{'invisible':[('is_invest_project','!=','1')]}">
                        <field name="pro_background" placeholder="请输入投资类项目背景"/>
                    </page>
              </xpath>
              <xpath expr="//field[@name='description']/parent::page" position="before">
                    <page string="项目空间">
                            <field name="project_space" mode="tree">
                                <tree string="项目空间" editable="bottom">
                                    <field name="categ_id_parent" options="{'no_create': True}"/>
                                    <field name="categ_id" options="{'no_create': True}"/>
                                    <field name="project_space"/>
                                    <field name="software_space"/>
                                </tree>
                                <form>
                                    <sheet>
                                        <group>
                                            <group>
                                                <field name="categ_id_parent"/>
                                                <field name="categ_id"/>
                                            </group>
                                            <group>
                                                <field name="project_space"/>
                                            </group>
                                        </group>
                                    </sheet>
                                </form>
                            </field>
                            <group class="oe_subtotal_footer oe_right" name="project_space_total">
                                <field name="space_total"  class="oe_subtotal_footer_separator"/>
                            </group>
                    </page>
                </xpath>
              <xpath expr="//page[@name='extra']" position="attributes">
                  <attribute name="invisible">1</attribute>
              </xpath>
              <xpath expr="//field[@name='description']" position="attributes">
                   <attribute name="string">项目进展</attribute>
              </xpath>
              <field name="tag_ids" position="attributes">
                  <attribute name="invisible">1</attribute>
              </field>
          </field>
      </record>

      <!-- CRM Lead Search View -->
        <record id="crm.view_crm_case_leads_filter" model="ir.ui.view">
            <field name="name">CRM - Leads Search</field>
            <field name="model">crm.lead</field>
            <field name="arch" type="xml">
                <search string="Search Leads">
                    <field name="project_number" string="项目编号"/>
                    <field name="name" string="项目名称" filter_domain="['|','|','|',('partner_id','ilike',self),('partner_name','ilike',self),('email_from','ilike',self),('name', 'ilike', self)]"/>
                    <field name="project_leave" string="项目级别"/>
                    <field name="office_id" string="办事处"/>
                    <field name="system_department_id" string="系统部"/>
                    <field name="bidding_time" string="招标时间"/>
                    <field name="space_total" string="项目空间"/>
                    <field name="name" string="Lead / Customer" filter_domain="['|','|','|',('partner_name','ilike',self),('email_from','ilike',self),('contact_name','ilike',self),('name','ilike',self)]"/>
                    <!--<field name="tag_ids" string="Tag" filter_domain="[('tag_ids', 'ilike', self)]"/>-->
                    <field name="team_id"/>
                    <field name="sale_apply_id"/>
                    <field name="partner_id" operator="child_of" string="Customer"/>
                    <field name="create_date"/>
                    <field name="country_id"/>
                    <separator />
                    <filter string="My Leads"
                            name="assigned_to_me"
                            domain="[('sale_apply_id_uid','=',uid)]"
                            help="Leads that are assigned to me"/>
                    <filter string="Unassigned" name="unassigned"
                            domain="[('user_id','=', False)]"
                            help="No salesperson"/>
                    <separator />
                    <filter string="Unread Messages" name="message_needaction" domain="[('message_needaction','=',True)]"/>
                    <filter string="Archived" name="archived" domain="[('active', '=', False)]"/>
                    <separator />
                    <filter string="Exclude Opt Out"
                            name='not_opt_out' domain="[('opt_out', '=', False)]"
                            help="Leads that did not ask not to be included in mass mailing campaigns"/>
                    <group expand="0" string="Group By">
                        <!--<filter string="Salesperson" name="groupby_salesperson" domain="[]" context="{'group_by':'user_id'}"/>-->
                        <filter string="Sales Team" name="groupby_team" domain="[]" context="{'group_by':'team_id'}"/>
                        <filter string="Stage" name="groupby_stage" domain="[]" context="{'group_by':'stage_id'}"/>
                        <filter string="办事处" name="groupby_office" domain="[]" context="{'group_by':'office_id'}"/>
                        <filter string="系统部" name="groupby_stage" domain="[]" context="{'group_by':'system_department_id'}"/>
                        <filter string="项目把握度" name="groupby_stage" domain="[]" context="{'group_by':'project_master_degree'}"/>
                        <filter string="项目级别" name="groupby_stage" domain="[]" context="{'group_by':'project_leave'}"/>

                        <!--<filter name="customer" string="Customer" help="Partner" domain="[]" context="{'group_by':'partner_id'}"/>-->
                        <!--<filter string="Campaign" name="groupby_campaign"  domain="[]" context="{'group_by':'campaign_id'}"/>-->
                        <!--<filter string="Source" name="groupby_source" domain="[]" context="{'group_by':'source_id'}"/>-->
                        <!--<filter string="Medium" name="groupby_channel" domain="[]" context="{'group_by':'medium_id'}"/>-->
                        <!--<filter string="Creation Month" name="groupby_createmonth" domain="[]" context="{'group_by':'create_date'}"/>-->
                    </group>
                </search>
            </field>
        </record>

      <!-- CRM Lead Kanban View  -->
      <record model="ir.ui.view" id="crm.crm_case_kanban_view_leads">
          <field name="name">CRM - Leads Kanban</field>
          <field name="model">crm.lead</field>
          <field name="arch" type="xml">
              <kanban default_group_by="stage_id" class="o_kanban_small_column" quick_create="false">
                  <field name="stage_id" options='{"group_by_tooltip": {"requirements": "Description", "legend_priority": "Use of stars"}}'/>
                  <field name="color"/>
                  <field name="priority"/>
                  <field name="planned_revenue"/>
                  <field name="user_email"/>
                  <field name="user_id"/>
                  <field name="partner_address_email"/>
                  <field name="message_needaction_counter"/>
                  <field name="tag_ids"/>
                  <field name="partner_id"/>
                  <field name="active"/>
                  <field name="company_currency"/>
                  <templates>
                      <field name="date_deadline"/>
                      <t t-name="kanban-box">
                          <div t-attf-class="#{kanban_color(record.color.raw_value)} oe_kanban_global_click">
                              <div class="o_dropdown_kanban dropdown">
                                  <a class="dropdown-toggle btn" data-toggle="dropdown" href="#" >
                                      <span class="fa fa-bars fa-lg"/>
                                  </a>
                                  <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                                      <t t-if="widget.editable"><li><a type="edit">Edit</a></li></t>
                                      <t t-if="widget.deletable"><li><a type="delete">Delete</a></li></t>
                                      <li t-if="! record.active.value"><a name="action_set_active" type="object">Unarchive</a></li>
                                      <li t-if="record.active.value"><a name="action_set_unactive" type="object">Archive</a></li>
                                      <li><ul class="oe_kanban_colorpicker" data-field="color"/></li>
                                  </ul>
                              </div>
                              <div class="oe_kanban_content">
                                  <div>
                                      <field name="tag_ids"/>
                                  </div>
                                  <div>
                                      <strong><field name="name"/></strong>
                                  </div>
                                  <div class="text-muted">
                                      <t t-if="record.planned_revenue.raw_value"><field name="planned_revenue" widget="monetary" options="{'currency_field': 'company_currency'}"/></t> <span t-if="record.partner_id.value"> - <t t-esc="record.partner_id.value"/></span>
                                  </div>
                                  <div class="text-muted">
                                      <t t-if="record.date_action.raw_value and record.date_action.raw_value lt (new Date())" t-set="red">oe_kanban_text_red</t>
                                      <span t-attf-class="#{red || ''}">
                                          <field name="date_action"/>
                                          <t t-if="record.date_action.raw_value"> : </t>
                                          <field name="next_activity_id"/>
                                      </span>
                                  </div>
                                  <div class="o_kanban_footer">
                                      <field name="priority" widget="priority" groups="base.group_user"/>
                                      <t t-if="record.message_needaction_counter.raw_value">
                                          <span class='oe_kanban_mail_new' title='Unread Messages'><i class='fa fa-comments'/><t t-raw="record.message_needaction_counter.raw_value"/></span>
                                      </t>
                                      <img t-att-src="kanban_image('res.users', 'image_small', record.user_id.raw_value)" t-att-title="record.user_id.value" width="24" height="24" class="oe_kanban_avatar pull-right"/>
                                  </div>
                              </div>
                              <div class="oe_clear"></div>
                          </div>
                      </t>
                  </templates>
              </kanban>
          </field>
      </record>

      <!--产品搜索界面增加产品分类分组-->
      <!--<record id="product_search_form_inherit_view" model="ir.ui.view">-->
          <!--<field name="name">product.template.search.inherit</field>-->
          <!--<field name="model">product.template</field>-->
          <!--<field name="inherit_id" ref="product.product_template_search_view"/>-->
          <!--<field name="arch" type="xml">-->
               <!--<field name="pricelist_id" position="after">-->
                  <!--<filter string="产品分类" name="categ_id" context="{'group_by':'categ_id'}"/>-->
               <!--</field>-->
          <!--</field>-->
      <!--</record>-->
      <record id="dtdream_product_category_search_view" model="ir.ui.view">
          <field name="name">dtdream.product.category.search</field>
          <field name="model">product.category</field>
          <field name="inherit_id" ref="product.product_category_search_view"/>
          <field name="arch" type="xml">
              <field name="parent_id" position="after">
                  <group expand="0" string="Group By">
                      <filter string="一级分类" context="{'group_by':'parent_id'}" name="group_by_parent_id"/>
                  </group>
              </field>
          </field>
      </record>

      <!--机会点转项目-->
      <record model="ir.ui.view" id="dtdream_sale.res_view_crm_lead2opportunity_partner">
            <field name="name">crm.lead2opportunity.form</field>
            <field name="model">crm.lead2opportunity.partner</field>
            <field name="inherit_id" ref="crm.view_crm_lead2opportunity_partner"/>
            <field name="arch" type="xml">
                <field name="user_id" position="replace">
                    <field name="sale_apply_id"/>
                </field>
            </field>
      </record>


      <!--销售团队字段修改-->
      <record model="ir.ui.view" id="dtdream_sale.crm_team_view_form">
            <field name="name">crm.team.form</field>
            <field name="model">crm.team</field>
            <field name="inherit_id" ref="sales_team.crm_team_view_form"/>
            <field name="arch" type="xml">
                <label for="name" position="replace">
                    <label for="name" class="oe_edit_only" string="项目团队"/>
                </label>
                <field name="name" position="replace">
                    <field name="name" placeholder="项目团队名称"/>
                </field>
                <xpath expr="//group[@name='left']/parent::group" position="attributes">
                    <attribute name="invisible">True</attribute>
                </xpath>
                <field name="member_ids" position="replace">
                    <field name="res_member_ids" widget="many2many_kanban" options="{'not_delete': True}">
                        <kanban quick_create="false" create="true" delete="true">
                            <field name="name"/>
                            <templates>
                                <t t-name="kanban-box">
                                    <div class="oe_kanban_global_click" style="position: relative">
                                        <a t-if="! read_only_mode" type="delete" style="position: absolute; right: 0; padding: 4px; diplay: inline-block">X</a>
                                        <div class="oe_module_vignette">
                                            <img t-att-src="kanban_image('res.users', 'image_small', record.id.value)" class="oe_avatar oe_kanban_avatar_smallbox"/>
                                            <div class="oe_module_desc">
                                                <field name="name"/>
                                            </div>
                                        </div>
                                    </div>
                                </t>
                            </templates>
                        </kanban>
                    </field>
                </field>
            </field>
      </record>

      <!-- Opportunities Search View -->
      <record id="crm.view_crm_case_opportunities_filter" model="ir.ui.view">
          <field name="name">CRM - Opportunities Search</field>
          <field name="model">crm.lead</field>
          <field name="arch" type="xml">
              <search string="Search Opportunities">
                  <field name="project_number" string="项目编号"/>
                  <field name="name" string="项目名称" filter_domain="['|','|','|',('partner_id','ilike',self),('partner_name','ilike',self),('email_from','ilike',self),('name', 'ilike', self)]"/>
                  <field name="project_leave" string="项目级别"/>
                  <field name="office_id" string="办事处"/>
                  <field name="system_department_id" string="系统部"/>
                  <field name="bidding_time" string="招标时间"/>
                  <field name="space_total" string="项目空间"/>
                  <!--<field name="tag_ids" string="Tag" filter_domain="[('tag_ids', 'ilike', self)]"/>-->
                  <field name="team_id"/>
                  <field name="sale_apply_id"/>
                  <field name="partner_id" operator="child_of" string="Customer"/>
                  <field name="stage_id" domain="[]"/>
                  <field name="lost_reason"/>
                  <separator/>
                  <filter string="我的项目" name="assigned_to_me"
                            domain="[('sale_apply_id_uid','=',uid)]"
                            help="营销责任人为我的项目"/>
                  <separator/>
                  <filter string="重点项目" name="important"
                          domain="[('is_important', '=', True)]"/>
                  <filter string="商机" name="lead"
                          domain="[('type', '=', 'lead')]"/>
                  <filter string="运作中的项目" name="filter_project_processing"
                          domain="[('stage_id.name', 'in', ['机会点','项目启动','技术和商务交流','项目招投标'])]"/>
                  <filter string="中标项目" name="won"
                          domain="[('is_won', '=', True)]"/>
                  <filter string="丢单项目" name="lost"
                          domain="[('is_lost', '=', True)]"/>
                  <separator/>
                  <filter string="Archived" domain="[('active', '=', False)]" groups="dtdream_sale.group_dtdream_sale_manager"/>
                  <group string="Group By">
                        <filter string="办事处" name="groupby_office" domain="[]" context="{'group_by':'office_id'}"/>
                        <filter string="系统部" name="groupby_stage" domain="[]" context="{'group_by':'system_department_id'}"/>
                        <filter string="阶段" name="groupby_stage_id" domain="[]" context="{'group_by':'stage_id'}"/>
                        <filter string="招标时间" name="groupby_time" domain="[]" context="{'group_by':'bidding_time'}"/>
                        <filter string="项目把握度" name="groupby_stage" domain="[]" context="{'group_by':'project_master_degree'}"/>
                        <filter string="项目是否有预算" name="groupby_is_project_budget" domain="[]" context="{'group_by':'is_project_budget'}"/>
                        <filter string="省份" name="groupby_province" domain="[]" context="{'group_by':'project_province_new'}"/>
                        <filter string="城市" name="groupby_city" domain="[]" context="{'group_by':'project_place_new'}"/>
                        <filter string="渠道" name="groupby_channel" domain="[]" context="{'group_by':'sale_channel'}"/>
                        <filter string="产品一级分类" name="groupby_pro_type" domain="[]" context="{'group_by':'categ_id_parent'}"/>
                        <filter string="产品二级分类" name="groupby_pro_type_deep" domain="[]" context="{'group_by':'categ_id'}"/>
                        <filter string="营销责任人" name="groupby_sale_apply_id" domain="[]" context="{'group_by':'sale_apply_id'}"/>
                    </group>
              </search>
          </field>
      </record>

      <record model="ir.actions.act_window" id="crm.crm_lead_opportunities_tree_view">
        <field name="name">Your Pipeline</field>
        <field name="res_model">crm.lead</field>
        <field name="view_mode">tree,kanban,graph,pivot,form,calendar</field>
        <field name="domain">[]</field>
        <field name="context">{
                        'default_type': 'lead',
                        'search_default_filter_project_processing': 1
        }</field>
        <field name="search_view_id" ref="crm.view_crm_case_opportunities_filter"/>
        <field name="view_id" ref="crm.crm_case_form_view_oppor"/>
        <field name="help" type="html">
            <p>
                Odoo helps you keep track of your sales pipeline to follow
                up potential sales and better forecast your future revenues.
            </p><p>
                You will be able to plan meetings and phone calls from
                opportunities, convert them into quotations, attach related
                documents, track all discussions, and much more.
            </p>
        </field>
    </record>

      <!--新增产品类别菜单-->
      <menuitem name="产品类别" action="product_pro_type_form_action" id="menu_product_pro_type_form_action" parent="product.prod_config_main" sequence="8" />

      <menuitem id="crm.crm_lead_menu_activities" name="Next Activities" sequence="5"
        parent="base.menu_sales" action="crm.crm_lead_action_activities" groups="group_menu_hide"/>
      <!--<menuitem id="base.menu_invoiced" name="Invoicing" parent="base.menu_aftersale" sequence="1" groups="group_menu_hide"/>-->
      //开票
      <menuitem name="Invoicing"
            id="sale.menu_sale_invoicing" parent="base.menu_base_partner"
            sequence="5" groups="group_menu_hide" />
      <menuitem action="sale.action_orders_to_invoice"
            id="sale.menu_sale_order_invoice" parent="sale.menu_sale_invoicing"
            sequence="2" groups="group_menu_hide"/>
      <menuitem action="sale.action_orders_upselling"
            id="sale.menu_sale_order_upselling" parent="sale.menu_sale_invoicing"
            sequence="5" groups="group_menu_hide"/>
      //报价
      <menuitem id="sale.menu_sale_quotations"
            action="sale.action_quotations" parent="base.menu_sales"
            sequence="11" groups="group_menu_hide"/>
      //销售订单
      <record id="sale.menu_sale_order" model="ir.ui.menu">
          <field name="groups_id" eval="[(6, 0, [ref('group_menu_hide')])]"/>
      </record>
      //销售顶级菜单
      <menuitem name="Sales"
            id="base.menu_base_partner"
            web_icon="sale,static/description/icon.png"
            groups="group_dtdream_sale_salesman_all_leads,group_dtdream_sale_salesman,group_dtdream_sale_manager,group_dtdream_sale_read,group_dtdream_sale_rep,group_dtdream_sale_office_manager,group_dtdream_office_product_vice_manager,group_dtdream_headquarters_server_manager,group_dtdream_server_manager,group_dtdream_marketing_department_manager,group_dtdream_marketing_department_vice_manager,group_dtdream_marketing_department_business_interface_person,group_dtdream_system_manager,group_dtdream_system_vice_manager,group_dtdream_system_product_vice_manager,group_dtdream_market_manager,group_dtdream_headquarters_product_manager,group_dtdream_product_director,group_dtdream_management_manager,group_dtdream_management_vice_manager,group_dtdream_management_product_vice_manager,group_dtdream_company_manager,group_dtdream_devolopement_manager,group_dtdream_sale_high_manager" sequence="6"/>

      //仪表盘
      <menuitem id="sales_team.menu_sales_team_act" action="sales_team.crm_team_salesteams_act" sequence="1" parent="base.menu_base_partner" name="Dashboard" groups="group_menu_hide"/>

      <menuitem id="base.menu_sales" name="Sales" parent="base.menu_base_partner" sequence="5" groups="group_menu_hide"/>

      <menuitem name="联系人" id="dtdream_sale.menu_contacts" sequence="11" action="mail.action_contacts" parent="base.menu_base_partner" groups="group_menu_hide"/>

      <menuitem action="product.product_template_action"
            id="product.menu_product_template_action"
            parent="base.menu_sales" sequence="13" groups="group_menu_hide"/>


      <delete id="crm.menu_crm_leads" model="ir.ui.menu"/>
      <menuitem name="机会点" id="crm.menu_crm_leads" parent="base.menu_base_partner" sequence="3" action="crm.crm_lead_all_leads" groups="group_menu_hide"/>
      <menuitem id="crm.menu_crm_opportunities" action="crm.action_your_pipeline" parent="base.menu_base_partner" sequence="4"/>
      <menuitem id="base.menu_partner_form" parent="base.menu_base_partner" action="base.action_partner_form" sequence="15"/>

      <menuitem name="产品" id="base.menu_top_dtdream_product" web_icon="dtdream_sale,static/description/product.png" action="product.product_template_action"/>

      <!--<menuitem name="产品层级图" id="product_tree_view_menuitem" action="action_product_tree_view" parent="base.menu_top_dtdream_product" sequence="2"/>-->

      <menuitem name="产品列表" id="product_list_view_menuitem" action="product.product_template_action" parent="base.menu_top_dtdream_product" sequence="1"/>


      <!--定义行政区域-->
      <record id="view_dtdream_area_form" model="ir.ui.view">
          <field name="name">view.dtdream.area.form</field>
          <field name="model">dtdream.area</field>
          <field name="arch" type="xml">
              <form>
                  <sheet>
                      <group>
                          <group>
                              <field name="name"/>
                              <field name="code"/>
                              <field name="parent_code"/>
                              <field name="province"/>
                              <field name="parent_id"/>
                          </group>
                          <group>
                              <field name="country"/>
                              <field name="area_code"/>
                              <field name="area_leave"/>
                              <field name="area_type"/>
                          </group>
                      </group>
                  </sheet>
              </form>
          </field>
      </record>

      <record id="view_dtdream_area_tree" model="ir.ui.view">
          <field name="name">view.dtdrean.area.tree</field>
          <field name="model">dtdream.area</field>
          <field name="field_parent">child_ids</field>
          <field name="arch" type="xml">
              <tree>
                  <field name="parent_id" invisible="True"/>
                  <field name="name"/>
                  <field name="code"/>
                  <field name="parent_code"/>
                  <field name="province"/>
                  <field name="country"/>
                  <field name="area_code"/>
                  <field name="area_leave"/>
                  <field name="area_type"/>
              </tree>
          </field>
      </record>

      <!--行政区域action定义-->
      <record id="act_dtdream_area" model="ir.actions.act_window">
          <field name="name">行政区域</field>
          <field name="type">ir.actions.act_window</field>
          <field name="res_model">dtdream.area</field>
          <field name="view_type">tree</field>
          <field name="view_mode">tree,list,form</field>
          <field name="domain">[('parent_id','=',False)]</field>
      </record>

      <!--定义行政区域菜单-->
      <menuitem name='行政区域配置' id='menu_setting_dtdream_area' parent='base.menu_sale_config' sequence="65" action="act_dtdream_area"/>

      <delete id="crm.ir_mark_as_lost" model="ir.values"/>
  </data>
</openerp>
