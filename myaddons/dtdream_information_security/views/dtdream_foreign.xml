<openerp>
    <data>

         <record model="ir.ui.view" id="dtdream_foreign_form">
            <field name="name">dtdream.foreign_form</field>
            <field name="model">dtdream.foreign</field>
            <field name="arch" type="xml">
                <form>
                    <header>
                        <button name="do_cgtj" string="提交" type="object" class="oe_highlight" confirm="请确认是否提交?" attrs="{'invisible':['|',('state','not in',('0')),('is_shenqingren','=',False)]}"/>
                        <button name="%(dtdream_information_security.foreign_act_agree)d" string="同意" type="action" class="oe_highlight" attrs="{'invisible':['|',('state','not in',('1','2','3','4')),('is_shenpiren','=',False)]}"> </button>
                        <button name="%(dtdream_information_security.foreign_act_reject)d" string="驳回" type="action" class="oe_highlight" attrs="{'invisible':['|',('state','not in',('1','2','3','4')),('is_shenpiren','=',False)]}"/>
                        <button name="%(dtdream_information_security.foreign_act_disagree)d" string="不同意" type="action" class="oe_highlight" attrs="{'invisible':['|',('state','not in',('2','3','4')),('is_shenpiren','=',False)]}"/>
                        <field name="state" widget="statusbar" statusbar_visible="0,1,2,3,4,-99,99"/>
                    </header>
                    <sheet>
                        <group string="基本信息">
                            <group>
                                <field name="applicant"/>
                                <field name="manager" attrs="{'readonly':['|',('state','not in',('0')),('is_shenqingren','=',False)]}"/>
                                <field name="is_shenpiren" invisible="1"/>
                                <field name="is_shenqingren" invisible="1"/>
                            </group>
                            <group>
                                <field name="department_01"/>
                                <field name="department_02"/>
                            </group>
                        </group>
                        <group string="披露信息">
                            <group>
                                <field name="name" attrs="{'readonly':['|',('state','not in',('0')),('is_shenqingren','=',False)]}"/>
                                <field name="target" attrs="{'readonly':['|',('state','not in',('0')),('is_shenqingren','=',False)]}"/>
                                <field name="target_email" attrs="{'readonly':['|',('state','not in',('0')),('is_shenqingren','=',False)]}"/>
                            </group>
                            <group>
                                <field name="origin_department_01" domain="[('parent_id','=',False)]" attrs="{'readonly':['|',('state','not in',('0')),('is_shenqingren','=',False)]}"/>
                                <field name="secret_person" placeholder="填写后，则需要信息安全员检查" attrs="{'readonly':['|',('state','not in',('0')),('is_shenqingren','=',False)]}"/>
                                <field name="secret_level" attrs="{'readonly':['|',('state','not in',('0')),('is_shenqingren','=',False)]}"/>
                            </group>
                            <group colspan="12" >
                                <field name="reason" attrs="{'readonly':['|',('state','not in',('0')),('is_shenqingren','=',False)]}"/>
                            </group>
                        </group>
                         <group colspan="12">
                              <field name="attachment_name" invisible="True"/>
                              <field name="attachment" widget="binary" filename="attachment_name" attrs="{'readonly':['|',('state','not in',('0')),('is_shenqingren','=',False)]}"/>
                              <field name="url_address" attrs="{'readonly':['|',('state','not in',('0')),('is_shenqingren','=',False)]}"/>
                         </group>
                      </sheet>
                      <div class="oe_chatter">
                          <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                          <field name="message_ids" widget="mail_thread"/>
                      </div>
                </form>
            </field>
        </record>
         <record id="dtdream_foreign_tree" model="ir.ui.view">
            <field name="name">dtdream_foreign_tree</field>
            <field name="model">dtdream.foreign</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="applicant"/>
                    <field name="target"/>
                    <field name="name"/>
                    <field name="state"/>
                    <field name="current_approve"/>
                </tree>
            </field>
        </record>


        <record id="dtdream_foreign_kanban" model="ir.ui.view">
            <field name="name">dtdream_foreign_kanban</field>
            <field name="model">dtdream.foreign</field>
            <field name="arch" type="xml">
                <kanban class="o_res_partner_kanban" >
                    <field name="applicant"/>
                    <field name="target"/>
                    <field name="name"/>
                    <field name="state"/>
                    <field name="current_approve"/>
                    <templates>
                        <t t-name="kanban-box">
                        <div class="oe_kanban_global_click ">
                             <div class="o_kanban_image">
                                  <img t-att-src="kanban_image('product.template', 'image_small', record.id.value)"/>
                              </div>
                            <div class="oe_kanban_details">
                                <div name="tags"/>
                                    <ul>
                                        <li ><strong>申请人:</strong> <field name="applicant" /></li>
                                        <li ><strong>披露信息:</strong> <field name="name" /></li>
                                        <li ><strong>状态:</strong> <field name="state" /></li>
                                    </ul>
                            <div name="tags"/>
                            </div>
                        </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>



        <record id="act_dtdream_foreign_self" model="ir.actions.act_window">
            <field name="name">我相关的</field>
            <field name="res_model">dtdream.foreign</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,kanban</field>
        </record>

        <record id="act_dtdream_foreign_wait" model="ir.actions.act_window">
            <field name="name">待我审批</field>
            <field name="res_model">dtdream.foreign</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,kanban</field>
            <field name="domain">[('current_approve.user_id','=',uid)]</field>
        </record>

        <record id="act_dtdream_foreign_all" model="ir.actions.act_window">
            <field name="name">所有对外披露</field>
            <field name="res_model">dtdream.foreign</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,kanban</field>
        </record>

        <menuitem id="dtdream_foreign_root"  parent="dtdream_information_security_root" sequence="120" name="对外披露"/>
        <menuitem name="我相关的" sequence="100" id="dtdream_foreign_menu_self"  parent="dtdream_foreign_root" action="act_dtdream_foreign_self"/>
        <menuitem name="待我审批" sequence="200" id="dtdream_foreign_menu_wait"  parent="dtdream_foreign_root" action="act_dtdream_foreign_wait"/>
        <menuitem name="所有对外披露" sequence="200" id="dtdream_foreign_menu_all"   parent="dtdream_informati_security_menu" action="act_dtdream_foreign_all"/>
    </data>
</openerp>