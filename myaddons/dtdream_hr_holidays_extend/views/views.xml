<?xml version="1.0" encoding="UTF-8" ?>
        <openerp>
            <data>
 <!--=======================================================================================view===================================================================-->
                <record id="edit_holiday_new_inher" model="ir.ui.view">
                  <field name="name">edit.holiday.new.inher</field>
                  <field name="model">hr.holidays</field>
                  <field name="inherit_id" ref="hr_holidays.edit_holiday_new"></field>
                  <field name="arch" type="xml">
                        <field name="type" position="before">
                            <field name="create_type"/>
                        </field>
                        <field name="employee_id"  position="replace" ></field>
                        <field name="department_id" position="replace"></field>

                        <field name="name" position="before">
                            <field name="employee_id" string="申请人"></field>
                            <field name="gonghao"></field>
                            <field name="department_id"></field>
                            <field name="create_time"></field>
                            <field name="current_shenpiren" attrs="{'invisible':'(1==1)'}"></field>
                            <field name="is_shenpiren" attrs="{'invisible':'(1==1)'}"></field>
                        </field>

                      <field name="holiday_type" position="before">
                          <!--<field name="year"></field>-->
                          <field name="shenpiren1" disabled="disabled"></field>
                          <field name="shenpiren2" attrs="{'readonly': ['|','&amp;',('state','in','confirm'),('is_shenpiren', '=', False),('state','not in',('draft','confirm'))],'invisible':[('create_type','in',('manage'))]}"/>
                          <field name="shenpiren3" attrs="{'readonly': ['|','&amp;',('state','in',('confirm','confirm2')),('is_shenpiren', '=', False),('state','not in',('draft','confirm','confirm2'))],'invisible':[('create_type','in',('manage'))]}"></field>
                          <field name="shenpiren4" attrs="{'readonly': ['|','&amp;',('state','in',('confirm','confirm2','confirm3')),('is_shenpiren', '=', False),('state','not in',('draft','confirm','confirm2','confirm3'))],'invisible':[('create_type','in',('manage'))]}"></field>
                          <field name="shenpiren5" attrs="{'readonly': ['|','&amp;',('state','in',('confirm','confirm2','confirm3','confirm4')),('is_shenpiren', '=', False),('state','not in',('draft','confirm','confirm2','confirm3','confirm4'))],'invisible':[('create_type','in',('manage'))]}"></field>


                      </field>
                        <xpath expr='//field[@name="name"]' position="attributes">
                             <attribute name="attrs">{'readonly': [('state','not in','draft')]}</attribute>
                        </xpath>
                        <xpath expr='//field[@name="holiday_status_id"]' position="attributes">
                             <attribute name="attrs">{'readonly': [('state','not in','draft')]}</attribute>
                        </xpath>
                        <xpath expr='//field[@name="date_from"]' position="attributes">
                             <attribute name="attrs">{'readonly': [('state','not in','draft')]}</attribute>
                        </xpath>
                        <xpath expr='//field[@name="date_to"]' position="attributes">
                             <attribute name="attrs">{'readonly': [('state','not in','draft')]}</attribute>
                        </xpath>
                        <xpath expr='//field[@name="number_of_days_temp"]' position="attributes">
                             <attribute name="attrs">{'readonly': [('state','not in','draft')]}</attribute>
                        </xpath>
                        <xpath expr='//button[@name="confirm"]' position="replace">
                             <button string="提交" name="confirm" states="draft" type="workflow" class="oe_highlight"/>
                        </xpath>
                        <xpath expr='//button[@name="reset"]' position="replace">
                             <button string="Reset to Draft" name="reset" type="workflow"
                                     attrs="{'invisible': ['|', ('can_reset', '=', False), ('state', 'not in', ['refuse'])]}"/>
                        </xpath>
                        <xpath expr='//button[@name="validate"]' position="replace">
                            <button string="通过" name="validate"  type="workflow"  groups="base.group_user" class="oe_highlight" attrs="{'invisible':['|',('is_shenpiren','=',False),('state','in',['draft','refuse','validate'])]}"/>
                        </xpath>
                        <xpath expr='//button[@name="refuse"]' position="replace">

                            <button string="驳回" name="refuse" type="workflow" groups="base.group_user" attrs="{'invisible':['|',('is_shenpiren','=',False),('state','in',['draft','refuse','validate'])]}"/>

                        </xpath>
                        <xpath expr='//field[@name="state"]' position="attributes">
                             <attribute name="statusbar_visible">draft,confirm,validate</attribute>
                        </xpath>


                  </field>
                </record>

                <record id="hr_holidays.view_hr_holidays_filter2" model="ir.ui.view">
                    <field name="name">hr.holidays.filter2</field>
                    <field name="model">hr.holidays</field>
                    <field name="arch" type="xml">
                        <search string="Search Annual_Leave">
                            <field name="name"/>
                            <field name="employee_id"/>
                            <field name="department_id"/>
                            <field name="state"></field>
                            <group expand="0" string="Group By">
                                <filter name="group_employee" string="Employee" context="{'group_by':'employee_id'}"/>
                                <filter name="group_category" string="Category" context="{'group_by':'category_id'}"/>
                                <filter string="Manager" context="{'group_by':'manager_id'}"/>
                                <filter name="group_type" string="Type" context="{'group_by':'holiday_status_id'}"/>
                                <filter name="group_state" string="状态" context="{'group_by':'state'}"></filter>

                            </group>
                        </search>
                    </field>
                </record>




                <record id="view_nianjia_batch_approval_from" model="ir.ui.view">
                    <field name="name">view.batch.approval.from</field>
                    <field name="model">batch.approval</field>
                    <field name="arch" type="xml">
                        <form string="批量审批">
                            <p>批量提交/审批选中项</p>
                            <footer>

                                <button string="确定" name="batch_approval" type="object" ></button>
                                or
                                <button string="取消" special="cancel"></button>
                            </footer>
                        </form>

                    </field>
                </record>


                 <!-- <record id="view_dtdream_hr_holidays_extend_new_menu_form" model="ir.ui.view">
                    <field name="name">view.dtdream.hr.holidays.extend.new.menu.form</field>
                    <field name="model">dtdream.hr.holidays.extend.new.menu</field>
                    <field name="arch" type="xml">
                        <form create="false" delete="false">
                          <sheet>
                            <group>
                                <group>
                                  <field name="shenpiren1"></field>
                                  <field name="shenpiren2"></field>
                                  <field name="shenpiren3"></field>
                                  <field name="shenpiren4"></field>
                                  <field name="shenpiren5"></field>

                                </group>
                                <group>
                                  <div>
                                    <p>1 无二级部门时：</p>
                                    <p>第一审批人：部门行政助理</p>
                                    <p>  第二审批人：一级部门主管</p>
                                    <p>  第三审批人：人力资源部部长（当请假时长超过一个月时）</p>
                                    <p>2 有二级部门时：</p>
                                    <p>  第一审批人：部门行政助理</p>
                                    <p>  第二审批人：二级部门主管</p>
                                    <p> 第三审批人：一级部门主管（当请假时长超过7天时）</p>
                                    <p>第四审批人：人力资源部部长（当请假时长超过一个月时）</p>
                                    <p>3 一级部门主管请假：</p>
                                    <p>第一审批人：部门行政助理</p>
                                    <p>第二审批人：EMT分管领导或总裁</p>
                                  </div>
                                </group>
                            </group>

                          </sheet>

                        </form>
                    </field>
                  </record>-->

<!--=============================================================================act_window====================================================================================-->

                  <record model="ir.actions.act_window" id="hr_holidays.open_department_holidays_approve"><!--待审批休假-->

                        <field name="name">Department Leaves</field>
                        <field name="res_model">hr.holidays</field>
                        <field name="view_type">form</field>
                        <field name="view_mode">tree,form,calendar</field>
                        <field name="context">{}</field>
                        <field name="domain">[('type','=','remove'),('current_shenpiren.user_id','=',uid)]</field>
                        <field name="search_view_id" ref="hr_holidays.view_hr_holidays_filter"/>
                  </record>

                  <record model="ir.actions.act_window" id="hr_holidays.open_company_allocation"><!--请假摘要-->

                        <field name="name">Leaves Summary</field>
                        <field name="res_model">hr.holidays</field>
                        <field name="view_type">form</field>
                        <field name="view_mode">tree,form</field>
                        <!--<field name="view_id" eval="hr_holidays.view_holiday_simple"></field>-->
                        <field name="context">{
                            'search_default_group_type': 1,
                            'search_default_year': 1 ,
                            'search_default_my_leaves': 1,
                            'needaction_menu_ref':
                            [
                                'hr_holidays.menu_open_ask_holidays_new',
                                'hr_holidays.menu_open_allocation_holidays',
                                'hr_holidays.menu_request_approve_allocation',
                                'hr_holidays.menu_open_employee_leave',
                            ]
                        }</field>

                        <field name="domain">[('holiday_type','=','employee')]</field>
                        <field name="search_view_id" ref="hr_holidays.view_hr_holidays_filter"/>
                  </record>

                  <record model="ir.actions.act_window" id="hr_holidays.open_ask_holidays"><!--请假申请-->

                        <field name="name">Leaves Request</field>
                        <field name="res_model">hr.holidays</field>
                        <field name="view_type">form</field>
                        <field name="view_id" ref="hr_holidays.edit_holiday_new"/>
                        <field name="context">{
                            'default_type': 'remove',
                            'search_default_my_leaves':1,
                            'needaction_menu_ref':
                            [
                                'hr_holidays.menu_open_company_allocation',
                            ]
                        }</field>
                        <field name="domain">[('type','=','remove'),('employee_id.user_id','=',uid)]</field>
                        <field name="search_view_id" ref="hr_holidays.view_hr_holidays_filter"/>
                        <field name="help" type="html">
                          <p class="oe_view_nocontent_create">
                            Click to create a new leave request.
                          </p><p>
                            Once you have recorded your leave request, it will be sent
                            to a manager for validation. Be sure to set the right leave
                            type (recuperation, legal holidays, sickness) and the exact
                            number of open days related to your leave.
                          </p>
                        </field>
                  </record>

                  <record model="ir.actions.act_window" id="hr_holidays.open_allocation_holidays2"><!--年休假分配-->
                        <field name="name">年休假分配</field>
                        <field name="res_model">hr.holidays</field>
                        <field name="view_type">form</field>
                        <field name="view_mode">form,tree</field>
                        <field name="context">{
                            'default_type':'add',
                            'default_name':'年休假分配',
                            'default_create_type': 'manage',
                            'search_default_group_state':1,
                            'needaction_menu_ref':
                            [
                                'hr_holidays.menu_open_company_allocation',
                            ]
                        }</field>
                        <field name="domain">[('type','=','add'),('create_type','=','manage')]</field>
                        <field name="view_id" ref="hr_holidays.edit_holiday_new"/>
                        <field name="view_id" ref="hr_holidays.view_holiday_allocation_tree"/>
                        <field name="search_view_id" ref="hr_holidays.view_hr_holidays_filter2"/>
                  </record>


                  <record model="ir.actions.act_window" id="hr_holidays.open_ask_holidays2"><!--年休假扣除-->
                        <field name="name">年休假扣除</field>
                        <field name="res_model">hr.holidays</field>
                        <field name="view_type">form</field>
                        <field name="view_mode">form,tree</field>
                        <field name="view_id" ref="hr_holidays.edit_holiday_new"/>
                        <field name="context">{
                            'default_type': 'remove',
                            'default_name':'年休假扣除',
                            'default_create_type': 'manage',
                            'search_default_group_state':1,
                            'needaction_menu_ref':
                            [
                                'hr_holidays.menu_open_company_allocation',
                            ]
                        }</field>
                        <field name="domain">[('type','=','remove'),('create_type','=','manage')]</field>
                        <field name="view_id" ref="hr_holidays.view_holiday_allocation_tree"/>
                        <field name="search_view_id" ref="hr_holidays.view_hr_holidays_filter2"/>

                  </record>


                  <record model="ir.actions.act_window" id="open_set_nianxiujia">
                        <field name="name">设置年休假</field>
                        <field name="res_model">dtdream.nianjia</field>
                        <field name="view_type">form</field>
                        <field name="view_mode">tree,form</field>
                  </record>
                  <record model="ir.actions.act_window" id="open_leave_remain">
                      <field name="name">剩余休假</field>
                      <field name="res_model">hr.holidays</field>
                      <field name="view_type">form</field>
                      <field name="view_mode">tree,form</field>
                      <field name="view_id" ref="hr_holidays.view_employee_form_leave_inherit"></field>
                  </record>

                  <act_window
                          multi="True"
                          key2="client_action_multi"
                          id="act_view_nianjia_batch_approval_from"
                          name="批量提交/审批"
                          src_model="hr.holidays"
                          res_model="batch.approval"
                          view_mode="form"
                          view_type="form"
                          target="new"
                          groups="base.group_hr_manager"/>


<!--=======================================================================================menuitem===================================================================-->
                 <!--<menuitem parent="hr_holidays.menu_hr_holidays_my_leaves" id="hr_holidays.menu_open_ask_holidays_new" action="hr_holidays.open_ask_holidays" sequence="22"/>-->
                 <menuitem name="Leaves to Approve" id="hr_holidays.menu_hr_holidays_approvals" parent="hr_holidays.menu_hr_holidays_root" sequence="3" groups="base.group_user"/>
                 <menuitem name="Leaves" parent="hr_holidays.menu_hr_holidays_approvals" id="hr_holidays.menu_open_department_leave_approve" groups="base.group_user" action="hr_holidays.open_department_holidays_approve" sequence="1"/>
                 <menuitem name="年休假设定" parent="hr_holidays.menu_hr_holidays_root" id="menu_open_set_nianxiujia" sequence="22" groups="base.group_hr_user"/>
                 <menuitem name="年休假分配" parent="menu_open_set_nianxiujia" id="open_allocate_request" action="hr_holidays.open_allocation_holidays2" groups="base.group_hr_user,base.group_hr_manager"></menuitem>
                 <menuitem name="年休假扣除" parent="menu_open_set_nianxiujia" id="open_allocate_mini" action="hr_holidays.open_ask_holidays2" groups="base.group_hr_user,base.group_hr_manager"></menuitem>
            </data>
        </openerp>